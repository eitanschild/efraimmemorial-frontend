<!DOCTYPE html>

<html dir="rtl" lang="he">
<head>
<link href="https://fonts.googleapis.com/css2?family=Varela+Round&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Varela+Round&amp;display=swap" rel="stylesheet"/>
<meta charset="utf-8"/>
<title>אתר זיכרון לאפרים יכמן</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    theme: {
      extend: {
        colors: {
          givati: '#5C1A7A'
        }
      }
    }
  }
</script>

<link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&amp;display=swap" rel="stylesheet"/>
<style>
    html {
      scroll-behavior: smooth;
    }
    body {
      background-image: url('https://www.transparenttextures.com/patterns/white-wall.png');
      background-repeat: repeat;
      background-color: #fefefe;
      font-family: 'Assistant', sans-serif;
    }
</style>
</head>
<body class="text-gray-800">


<!-- Navigation Bar -->
<nav class="bg-white/80 backdrop-blur-md border-b border-gray-300 shadow-sm sticky top-0 z-50">
  <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
    <div class="flex items-center gap-6 text-blue-900 font-bold text-base md:text-lg">
      <a href="index.html" class="hover:text-blue-700">דף הבית</a>
      <a href="ktavim.html" class="hover:text-blue-700">כתבי אפרים</a>
      <a href="memories.html" class="hover:text-blue-700">מכתבים וזכרונות</a>
      <a href="gallery.html" class="hover:text-blue-700">גלריה</a>
      <a href="#videos" class="hover:text-blue-700">סרטונים</a>
    </div>
    <span class="text-sm text-gray-500 hidden md:inline">לזכרו של אפרים יכמן ז"ל</span>
  </div>
</nav>

<!-- Hero Section with Background -->
<section class="relative h-[90vh] overflow-hidden bg-cover bg-center" style="background-image: url('https://efraimemorial-production.up.railway.app/uploads/hero-bg.jpg'); background-size: 130%;">
<div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm"></div>
<div class="relative z-10 flex flex-col items-center justify-center h-full text-white text-center px-4">
<img alt="אפרים יכמן" class="w-40 h-40 rounded-full border-4 border-white shadow-lg mb-6" src="images/ephraim.jpg"/>
<p class="text-xl md:text-2xl text-white font-semibold mb-4" style="font-family:'Varela Round', sans-serif;">"היופי האמיתי הוא האמת"</p>
<h1 class="text-4xl md:text-5xl font-bold mb-4">אפרים יכמן</h1>
<p class="text-lg md:text-xl leading-relaxed max-w-2xl">
      בן ליאת ושמואל, אח לאלישבע, בנימין, יוסף, חנה, אביגיל ורבקה<br/>
      נפל בקרב בעזה, ט"ו בטבת תשפ"ד (26.12.2023), בן 21 בנופלו
    </p>
</div>
</section>

<script>
  async function loadKtavim() {
    const res = await fetch('https://efraimemorial-production.up.railway.app/api/ktavim');
    const all = await res.json(); const ktavim = all.filter(k => k.approved);
    const container = document.getElementById('ktavimContainer');
    container.innerHTML = '';

    if (!ktavim.length) {
      container.innerHTML = '<p class="text-center text-gray-600">אין עדיין כתבים להצגה.</p>';
      return;
    }

    ktavim.reverse().slice(0, 2).forEach((k, i) => {
      const div = document.createElement('div');
      div.className = 'bg-gray-100 p-6 rounded-xl shadow-lg';

      if (i === 0) {
        div.innerHTML = `
          <h3 class="text-xl font-bold text-gray-800 mb-4">${k.title}</h3>
          <p class="text-lg text-gray-700 leading-relaxed whitespace-pre-line">${k.content}</p>
        `;
      } else {
        const short = k.content.length > 500 ? k.content.substring(0, 500) + "..." : k.content;
        div.innerHTML = `
          <h3 class="text-xl font-bold text-gray-800 mb-4">${k.title}</h3>
          <p class="text-lg text-gray-700 leading-relaxed whitespace-pre-line" id="ktav-preview-${i}" data-expanded="false">${short}</p>
        `;
      }

      container.appendChild(div);
    });
  }

  function toggleKtav(index, fullText) {
    const p = document.getElementById(`ktav-preview-${index}`);
    const isExpanded = p.dataset.expanded === "true";

    if (!isExpanded) {
      p.innerText = fullText;
      p.dataset.expanded = "true";
    } else {
      p.innerText = fullText.length > 500 ? fullText.substring(0, 500) + "..." : fullText;
      p.dataset.expanded = "false";
    }
  }

  loadKtavim();
</script>
<!-- Hero Section -->
<!-- About Section -->
<section class="py-10 px-6 bg-gray-100">
<div class="max-w-4xl mx-auto text-center">
<h2 class="text-2xl md:text-4xl font-bold text-blue-900 mb-6">אודות אפרים</h2>
<p class="text-lg leading-relaxed text-gray-800">
        בנם של ליאת ושמואל. נולד ביום כ"ו באדר תשס"ב (10.3.2002) באלון שבות. אח לאלישבע, בנימין, יוסף, חנה, אביגיל ורבקה.<br/>
        ביום 11.11.2021 התגייס לצה"ל ושירת בחטיבת גבעתי.<br/>
        סמל אפרים יכמן נפל בקרב ביום ט"ו בטבת תשפ"ד (26.12.2023). בן עשרים ואחת בנופלו. הוא הובא למנוחות בחלקה הצבאית בבית העלמין כפר עציון. הותיר אחריו הורים ושישה אחים.<br/>
        לאחר נפילתו הועלה לדרגת סמל ראשון.
      </p>
</div>
</section>
<!-- Ephraim's Writings Section -->
<section id="ktavim" class="py-10 px-6 bg-white" id="ktavim">
<div class="max-w-5xl mx-auto">
<h2 class="text-2xl md:text-4xl font-bold text-blue-900 mb-10 text-center">כתבי אפרים</h2>
<div class="grid gap-6 md:grid-cols-2 mb-8" id="ktavimContainer"></div>
<div class="text-center">
<a class="inline-block bg-blue-900 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition" href="ktavim.html">
        לצפייה בכל הכתבים
      </a>
</div>
</div>
</section>

<!-- Gallery Preview -->
<section id="gallery" class="py-10 px-6" style="background-color: transparent;">
  <div class="max-w-6xl mx-auto">
  <h2 class="text-2xl md:text-4xl font-bold text-blue-900 mb-10 text-center">גלריית תמונות</h2>
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mb-8" id="galleryPreview"></div>
  <div class="text-center mt-6">
  <a class="inline-block bg-blue-900 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition" href="gallery.html">לצפייה בכל התמונות</a>
  </div>
  </div>
  </section>
  <script>
  window.addEventListener('DOMContentLoaded', () => {
  async function loadGalleryPreview() {
      const res = await fetch('https://efraimemorial-production.up.railway.app/api/gallery/approved');
      const data = await res.json();
      const grid = document.getElementById('galleryPreview');
      grid.innerHTML = ''; if (data.length === 0) { grid.innerHTML = '<p class="text-center text-gray-500 col-span-full">אין תמונות להצגה כרגע.</p>'; return; }
      data.reverse().slice(0, 6).forEach(img => {
        const div = document.createElement('div');
        div.className = "bg-white rounded-lg shadow p-2";
        div.innerHTML = `
          <img src="${img.url}" ... />
          <p class="mt-2 text-sm text-gray-600">${img.caption || ""}</p>
        `;
        grid.appendChild(div);
      });
    }
    loadGalleryPreview();
  });
  </script>
  
<!-- Letters & Memories Section -->
<section id="memories" class="py-10 px-6 bg-gray-50">
  <div class="max-w-6xl mx-auto">
    <h2 class="text-2xl md:text-4xl font-bold text-blue-900 mb-10 text-center">מכתבים וזכרונות</h2>

    <!-- Memories Grid -->
    <div id="memoriesFullContainer" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>

    <!-- View All Button -->
    <div class="text-center mt-8">
      <a class="inline-block bg-blue-900 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition" href="memories.html">
        לצפייה בכל המכתבים
      </a>
    </div>
  </div>
</section>

<!-- Script to Load Memories -->
<script>
  async function loadMemories() {
    const res = await fetch('https://efraimemorial-production.up.railway.app/api/memories/approved');
    const memories = await res.json();
    const container = document.getElementById('memoriesFullContainer');
    container.innerHTML = '';

    if (memories.length === 0) {
      container.innerHTML = '<p class="text-center text-gray-600 col-span-full">אין עדיין זיכרונות מאושרים להצגה.</p>';
      return;
    }

    memories.reverse().slice(0, 4).forEach(mem => {
      const div = document.createElement('div');
      div.className = 'bg-white p-6 rounded-xl shadow text-right';
      div.innerHTML = `
        <p class="text-lg leading-relaxed mb-4 whitespace-pre-line text-gray-800">${mem.message}</p>
        <p class="text-sm text-gray-600 text-left mt-2">– ${mem.name}</p>
      `;
      container.appendChild(div);
    });
  }

  loadMemories();
</script>

<!-- Submit Memory -->
<script>
window.addEventListener('DOMContentLoaded', () => {
const memoryForm = document.getElementById('memoryForm');
    memoryForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const message = document.getElementById('message').value;

      const res = await fetch('https://efraimemorial-production.up.railway.app/api/memories', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, message })
      });

      if (res.ok) {
        document.getElementById('memoryResponse').classList.remove('hidden');
        memoryForm.reset();
      } else {
        alert('שגיאה בשליחה');
      }
    });
});
</script>
<!-- Gallery Display -->
<script>
  window.addEventListener('DOMContentLoaded', () => {
    async function loadGalleryPreview() {
      const res = await fetch('https://efraimemorial-production.up.railway.app/api/gallery/approved');
      const data = await res.json();
      const grid = document.getElementById('galleryPreview');
      grid.innerHTML = '';

      if (data.length === 0) {
        grid.innerHTML = '<p class="text-center text-gray-500 col-span-full">אין תמונות להצגה כרגע.</p>';
        return;
      }

      data.reverse().slice(0, 6).forEach(img => {
        const src = img.url; // We assume all approved entries are Cloudinary now

        const div = document.createElement('div');
        div.className = "bg-white rounded-lg shadow p-2";
        div.innerHTML = `
          <img src="${src}" alt="${img.caption || ''}" class="w-full h-64 object-cover rounded" />
          <p class="mt-2 text-sm text-gray-600">${img.caption || ""}</p>
        `;
        grid.appendChild(div);
      });
    }

    loadGalleryPreview();
  });
</script>



<!--video section-->

<section id="videos" class="py-14 px-6" style="background-image: url('https://www.transparenttextures.com/patterns/white-wall.png'); background-repeat: repeat;">
  <div class="max-w-6xl mx-auto">
    <h2 class="text-2xl md:text-4xl font-bold text-blue-900 mb-10 text-center">סרטונים לזכר אפרים</h2>
    

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- Video 1 -->
      <div class="w-full h-64 rounded-xl overflow-hidden shadow bg-black">
        <iframe class="w-full h-full" 
                src="https://www.youtube.com/embed/ZpiBhteibZM" 
                title="סרטון 1 לזכר אפרים" 
                frameborder="0" 
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                allowfullscreen>
        </iframe>
      </div>

      <!-- Video 2 -->
      <div class="w-full h-64 rounded-xl overflow-hidden shadow bg-black">
        <iframe class="w-full h-full" 
                src="https://www.youtube.com/embed/LEJ2h6bgmoM" 
                title="סרטון 2 לזכר אפרים" 
                frameborder="0" 
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                allowfullscreen>
        </iframe>
      </div>
    </div>
  </div>
</section>

    <!-- Upload Image Form -->
<script>
window.addEventListener('DOMContentLoaded', () => {
async function loadMemoriesPreview() {
    const res = await fetch('https://efraimemorial-production.up.railway.app/api/memories/approved');
    const data = await res.json();
    const container = document.getElementById('memoriesPreview');
    container.innerHTML = ''; if (data.length === 0) { container.innerHTML = '<p class="text-center text-gray-500">אין זיכרונות להצגה כרגע.</p>'; return; }
    data.reverse().slice(0, 4).forEach(mem => {
      const div = document.createElement('div');
      div.className = 'bg-gray-100 p-6 rounded-xl shadow';
      div.innerHTML = `
        <h3 class="text-xl font-bold text-gray-800 mb-2">${mem.name}</h3>
        <p class="text-md text-gray-700 whitespace-pre-line leading-relaxed">${mem.message}</p>
      `;
      container.appendChild(div);
    });
  }
  loadMemoriesPreview();
});
</script>
<section class="py-10 px-6 bg-white">
  <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8">


<div>
  <h2 class="text-2xl md:text-3xl font-bold text- mb-6 text-center">העלה תמונה לגלריה</h2>
  <form class="bg-blue-900 p-6 rounded-xl shadow space-y-4" enctype="multipart/form-data" id="galleryForm">
    <input
      accept="image/*"
      class="w-full p-3 border rounded-lg bg-white"
      id="image"
      name="image"
      required
      type="file"
    />
    <input
      class="w-full p-3 border rounded-lg"
      id="uploader"
      name="uploader"
      placeholder="שמך (המשלח)"
      required
      type="text"
    />
    <input
      class="w-full p-3 border rounded-lg"
      id="caption"
      name="caption"
      placeholder="כיתוב לתמונה (לא חובה)"
      type="text"
    />
    <button
      class="w-full bg-blue-900 text-white py-3 rounded-lg hover:bg-blue-900/90 transition"
      type="submit"
    >
      שלח תמונה
    </button>
    <p class="text-green-600 text-center mt-4 hidden" id="galleryResponse">
      התמונה נשלחה וממתינה לאישור
    </p>
    <p class="text-red-600 text-center mt-4 hidden" id="galleryError">
      שגיאה בהעלאת התמונה
    </p>
  </form>
</div>

<script>
  const galleryForm = document.getElementById('galleryForm');

  galleryForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const file = document.getElementById('image').files[0];
    if (!file) return;

    // 5MB limit
    if (file.size > 5 * 1024 * 1024) {
      alert('גודל התמונה חורג מהמותר (מקסימום 5MB).');
      return;
    }

    const formData = new FormData();
    formData.append('image', file);
    formData.append('caption', document.getElementById('caption').value);
    formData.append('uploader', document.getElementById('uploader').value);

    try {
      const res = await fetch('https://efraimemorial-production.up.railway.app/api/gallery', {
        method: 'POST',
        body: formData
      });

      if (res.ok) {
        document.getElementById('galleryResponse').classList.remove('hidden');
        document.getElementById('galleryError').classList.add('hidden');
        galleryForm.reset();
      } else {
        document.getElementById('galleryError').classList.remove('hidden');
        document.getElementById('galleryResponse').classList.add('hidden');
      }
    } catch (err) {
      console.error('Upload error:', err);
      document.getElementById('galleryError').classList.remove('hidden');
      document.getElementById('galleryResponse').classList.add('hidden');
    }
  });
</script>


    <!-- Submit Memory Form -->
    <div>
      <h2 class="text-2xl md:text-3xl font-bold text-blue-900 mb-6 text-center">שלחו זיכרון או מכתב</h2>
      <form class="bg-gray-50 p-6 rounded-xl shadow space-y-4" id="memoryForm">
        <input class="w-full p-3 border rounded-lg" id="name" name="name" placeholder="שמך" required type="text" />
        <textarea class="w-full p-3 border rounded-lg" id="message" name="message" placeholder="זיכרון או מכתב..." required rows="5"></textarea>
        <button class="w-full bg-blue-900 text-white py-3 rounded-lg hover:bg-blue-900 transition" type="submit">שלח זיכרון</button>
        <p class="text-green-600 text-center mt-4 hidden" id="memoryResponse">הזיכרון נשלח וממתין לאישור</p>
      </form>
    </div>

  </div>
</section>
</body>
</html>
