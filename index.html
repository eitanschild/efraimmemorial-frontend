<!DOCTYPE html>

<html dir="rtl" lang="he">
<head>
<link href="https://fonts.googleapis.com/css2?family=Varela+Round&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Varela+Round&amp;display=swap" rel="stylesheet"/>
<meta charset="utf-8"/>
<title>אתר זיכרון לאפרים יכמן</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700&amp;display=swap" rel="stylesheet"/>
<style>
    body {
      font-family: 'Assistant', sans-serif;
    }
  </style>
<style>
    body {
      background-image: url('https://www.transparenttextures.com/patterns/white-wall.png');
      background-repeat: repeat;
      background-color: #fefefe;
      font-family: 'Assistant', sans-serif;
    }
  </style>
</head>
<body class="text-gray-800">
<!-- Hero Section with Background -->
<section class="relative h-[90vh] overflow-hidden bg-cover bg-center" style="background-image: url('http://localhost:3001/uploads/hero-bg.jpg'); background-size: 130%;">
<div class="absolute inset-0 bg-black bg-opacity-50 backdrop-blur-sm"></div>
<div class="relative z-10 flex flex-col items-center justify-center h-full text-white text-center px-4">
<img alt="אפרים יכמן" class="w-40 h-40 rounded-full border-4 border-white shadow-lg mb-6" src="images/ephraim.jpg"/>
<p class="text-xl md:text-2xl text-white font-semibold mb-4" style="font-family:'Varela Round', sans-serif;">"היופי האמיתי הוא האמת"</p>
<h1 class="text-4xl md:text-5xl font-bold mb-4">אפרים יכמן</h1>
<p class="text-lg md:text-xl leading-relaxed max-w-2xl">
      בן ליאת ושמואל, אח לאלישבע, בנימין, יוסף, חנה, אביגיל ורבקה<br/>
      נפל בקרב בעזה, ט"ו בטבת תשפ"ד (26.12.2023), בן 21 בנופלו
    </p>
</div>
</section>
<script>
  async function loadKtavim() {
    const res = await fetch('http://localhost:3001/api/ktavim');
    const all = await res.json(); const ktavim = all.filter(k => k.approved);
    const container = document.getElementById('ktavimContainer');
    container.innerHTML = '';

    if (!ktavim.length) {
      container.innerHTML = '<p class="text-center text-gray-600">אין עדיין כתבים להצגה.</p>';
      return;
    }

    ktavim.reverse().slice(0, 2).forEach((k, i) => {
      const div = document.createElement('div');
      div.className = 'bg-gray-100 p-6 rounded-xl shadow-lg';

      if (i === 0) {
        div.innerHTML = `
          <h3 class="text-xl font-bold text-gray-800 mb-4">${k.title}</h3>
          <p class="text-lg text-gray-700 leading-relaxed whitespace-pre-line">${k.content}</p>
        `;
      } else {
        const short = k.content.length > 500 ? k.content.substring(0, 500) + "..." : k.content;
        div.innerHTML = `
          <h3 class="text-xl font-bold text-gray-800 mb-4">${k.title}</h3>
          <p class="text-lg text-gray-700 leading-relaxed whitespace-pre-line" id="ktav-preview-${i}" data-expanded="false">${short}</p>
        `;
      }

      container.appendChild(div);
    });
  }

  function toggleKtav(index, fullText) {
    const p = document.getElementById(`ktav-preview-${index}`);
    const isExpanded = p.dataset.expanded === "true";

    if (!isExpanded) {
      p.innerText = fullText;
      p.dataset.expanded = "true";
    } else {
      p.innerText = fullText.length > 500 ? fullText.substring(0, 500) + "..." : fullText;
      p.dataset.expanded = "false";
    }
  }

  loadKtavim();
</script>
<!-- Hero Section -->
<!-- About Section -->
<section class="py-10 px-6 bg-gray-100">
<div class="max-w-4xl mx-auto text-center">
<h2 class="text-2xl md:text-4xl font-bold text-blue-900 mb-6">אודות אפרים</h2>
<p class="text-lg leading-relaxed text-gray-800">
        בנם של ליאת ושמואל. נולד ביום כ"ו באדר תשס"ב (10.3.2002) באלון שבות. אח לאלישבע, בנימין, יוסף, חנה, אביגיל ורבקה.<br/>
        ביום 11.11.2021 התגייס לצה"ל ושירת בחטיבת גבעתי.<br/>
        סמל אפרים יכמן נפל בקרב ביום ט"ו בטבת תשפ"ד (26.12.2023). בן עשרים ואחת בנופלו. הוא הובא למנוחות בחלקה הצבאית בבית העלמין כפר עציון. הותיר אחריו הורים ושישה אחים.<br/>
        לאחר נפילתו הועלה לדרגת סמל ראשון.
      </p>
</div>
</section>
<!-- Ephraim's Writings Section -->
<section class="py-10 px-6 bg-white" id="ktavim">
<div class="max-w-5xl mx-auto">
<h2 class="text-2xl md:text-4xl font-bold text-blue-900 mb-10 text-center">כתבי אפרים</h2>
<div class="grid gap-6 md:grid-cols-2 mb-8" id="ktavimContainer"></div>
<div class="text-center">
<a class="inline-block bg-blue-800 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition" href="ktavim.html">
        לצפייה בכל הכתבים
      </a>
</div>
</div>
</section>

<!-- Gallery Preview -->
<section class="py-10 px-6" style="background-color: transparent;">
  <div class="max-w-6xl mx-auto">
  <h2 class="text-2xl md:text-4xl font-bold text-blue-900 mb-10 text-center">גלריית תמונות</h2>
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 mb-8" id="galleryPreview"></div>
  <div class="text-center mt-6">
  <a class="inline-block bg-blue-800 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition" href="gallery.html">לצפייה בכל התמונות</a>
  </div>
  </div>
  </section>
  <script>
  window.addEventListener('DOMContentLoaded', () => {
  async function loadGalleryPreview() {
      const res = await fetch('http://localhost:3001/api/gallery/approved');
      const data = await res.json();
      const grid = document.getElementById('galleryPreview');
      grid.innerHTML = ''; if (data.length === 0) { grid.innerHTML = '<p class="text-center text-gray-500 col-span-full">אין תמונות להצגה כרגע.</p>'; return; }
      data.reverse().slice(0, 6).forEach(img => {
        const div = document.createElement('div');
        div.className = "bg-white rounded-lg shadow p-2";
        div.innerHTML = `
          <img src="http://localhost:3001/gallery/${img.filename}" alt="" class="w-full h-64 object-cover rounded" />
          <p class="mt-2 text-sm text-gray-600">${img.caption || ""}</p>
        `;
        grid.appendChild(div);
      });
    }
    loadGalleryPreview();
  });
  </script>
  
<!-- Letters & Memories Section -->
<section class="py-10 px-6 bg-gray-50">
  <div class="max-w-6xl mx-auto">
    <h2 class="text-2xl md:text-4xl font-bold text-blue-900 mb-10 text-center">מכתבים וזכרונות</h2>

    <!-- Memories Grid -->
    <div id="memoriesFullContainer" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>

    <!-- View All Button -->
    <div class="text-center mt-8">
      <a class="inline-block bg-blue-800 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition" href="memories.html">
        לצפייה בכל המכתבים
      </a>
    </div>
  </div>
</section>

<!-- Script to Load Memories -->
<script>
  async function loadMemories() {
    const res = await fetch('http://localhost:3001/api/memories/approved');
    const memories = await res.json();
    const container = document.getElementById('memoriesFullContainer');
    container.innerHTML = '';

    if (memories.length === 0) {
      container.innerHTML = '<p class="text-center text-gray-600 col-span-full">אין עדיין זיכרונות מאושרים להצגה.</p>';
      return;
    }

    memories.reverse().slice(0, 4).forEach(mem => {
      const div = document.createElement('div');
      div.className = 'bg-white p-6 rounded-xl shadow text-right';
      div.innerHTML = `
        <p class="text-lg leading-relaxed mb-4 whitespace-pre-line text-gray-800">${mem.message}</p>
        <p class="text-sm text-gray-600 text-left mt-2">– ${mem.name}</p>
      `;
      container.appendChild(div);
    });
  }

  loadMemories();
</script>

<!-- Submit Memory -->
<script>
window.addEventListener('DOMContentLoaded', () => {
const memoryForm = document.getElementById('memoryForm');
    memoryForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const message = document.getElementById('message').value;

      const res = await fetch('http://localhost:3001/api/memories', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ name, message })
      });

      if (res.ok) {
        document.getElementById('memoryResponse').classList.remove('hidden');
        memoryForm.reset();
      } else {
        alert('שגיאה בשליחה');
      }
    });
});
</script>
<!-- Gallery Display -->
<script>
    async function loadGallery() {
      const res = await fetch('http://localhost:3001/api/gallery/approved');
      const data = await res.json();
      const grid = document.getElementById('galleryGrid');
      grid.innerHTML = '';

      if (!data.length) {
        grid.innerHTML = '<p class="text-center text-gray-600 col-span-full">אין תמונות להצגה עדיין.</p>';
        return;
      }

      data.forEach(item => {
        const div = document.createElement('div');
        div.className = 'bg-white rounded-xl shadow overflow-hidden';
        div.innerHTML = `
          <img src="http://localhost:3001/gallery/${item.filename}" class="w-full h-64 object-cover" />
          <div class="p-4 text-center text-sm text-gray-700">${item.caption || ''}<br/><span class="text-xs text-gray-500">נשלח על ידי: ${item.uploader || "לא ידוע"}</span></div>
        `;
        grid.appendChild(div);
      });
    }

    loadGallery();
  </script>
<!-- Gallery Upload Section -->
<script>
window.addEventListener('DOMContentLoaded', () => {
const galleryForm = document.getElementById('galleryForm');
    galleryForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData();
      formData.append('image', document.getElementById('image').files[0]);
      formData.append('caption', document.getElementById('caption').value);
      formData.append('uploader', document.getElementById('uploader').value);

      const res = await fetch('http://localhost:3001/api/gallery', {
        method: 'POST',
        body: formData
      });

      if (res.ok) {
        document.getElementById('galleryResponse').classList.remove('hidden');
        galleryForm.reset();
      } else {
        alert('שגיאה בהעלאת התמונה');
      }
    });
});
</script>

<script>
window.addEventListener('DOMContentLoaded', () => {
async function loadMemoriesPreview() {
    const res = await fetch('http://localhost:3001/api/memories/approved');
    const data = await res.json();
    const container = document.getElementById('memoriesPreview');
    container.innerHTML = ''; if (data.length === 0) { container.innerHTML = '<p class="text-center text-gray-500">אין זיכרונות להצגה כרגע.</p>'; return; }
    data.reverse().slice(0, 4).forEach(mem => {
      const div = document.createElement('div');
      div.className = 'bg-gray-100 p-6 rounded-xl shadow';
      div.innerHTML = `
        <h3 class="text-xl font-bold text-gray-800 mb-2">${mem.name}</h3>
        <p class="text-md text-gray-700 whitespace-pre-line leading-relaxed">${mem.message}</p>
      `;
      container.appendChild(div);
    });
  }
  loadMemoriesPreview();
});
</script>
<section class="py-10 px-6 bg-white">
<div class="max-w-2xl mx-auto">
<h2 class="text-2xl md:text-3xl font-bold text-blue-900 mb-6 text-center">העלה תמונה לגלריה</h2>
<form class="bg-gray-50 p-6 rounded-xl shadow space-y-4" enctype="multipart/form-data" id="galleryForm">
<input accept="image/*" class="w-full p-3 border rounded-lg bg-white" id="image" name="image" required="" type="file"/>
<input class="w-full p-3 border rounded-lg" id="uploader" name="uploader" placeholder="שמך (מי שלח את התמונה)" required="" type="text"/>
<input class="w-full p-3 border rounded-lg" id="caption" name="caption" placeholder="כתוב כיתוב לתמונה (לא חובה)" type="text"/>
<button class="w-full bg-blue-900 text-white py-3 rounded-lg hover:bg-blue-800 transition" type="submit">שלח תמונה</button>
<p class="text-green-600 text-center mt-4 hidden" id="galleryResponse">התמונה נשלחה וממתינה לאישור</p>
</form>
</div>
</section>

<section class="py-10 px-6 bg-white">
  <div class="max-w-2xl mx-auto">
    <h2 class="text-2xl md:text-3xl font-bold text-blue-900 mb-6 text-center">שלחו זיכרון או מכתב</h2>
    <form class="bg-gray-50 p-6 rounded-xl shadow space-y-4" id="memoryForm">
      <input class="w-full p-3 border rounded-lg" id="name" name="name" placeholder="שמך" required type="text" />
      <textarea class="w-full p-3 border rounded-lg" id="message" name="message" placeholder="זיכרון או מכתב..." required rows="5"></textarea>
      <button class="w-full bg-blue-900 text-white py-3 rounded-lg hover:bg-blue-800 transition" type="submit">שלח זיכרון</button>
      <p class="text-green-600 text-center mt-4 hidden" id="memoryResponse">הזיכרון נשלח וממתין לאישור</p>
    </form>
  </div>
</section>
</body>
</html>
